// This file is auto-generated. Do not modify manually.
// Generated by CrossPacket
import 'dart:convert';
import 'dart:typed_data';
import 'package:msgpack_dart/msgpack_dart.dart' as msgpack;
import '../data_packet.dart';

/// Formats a DateTime with timezone offset (ISO 8601).
String _formatDateTimeWithTimezone(DateTime dt) {
  final offset = dt.timeZoneOffset;
  final offsetSign = offset.isNegative ? '-' : '+';
  final offsetHours = offset.abs().inHours.toString().padLeft(2, '0');
  final offsetMinutes = (offset.abs().inMinutes % 60).toString().padLeft(2, '0');
  final year = dt.year.toString().padLeft(4, '0');
  final month = dt.month.toString().padLeft(2, '0');
  final day = dt.day.toString().padLeft(2, '0');
  final hour = dt.hour.toString().padLeft(2, '0');
  final minute = dt.minute.toString().padLeft(2, '0');
  final second = dt.second.toString().padLeft(2, '0');
  final millisecond = dt.millisecond.toString().padLeft(3, '0');
  return '$year-$month-${day}T$hour:$minute:$second.$millisecond$offsetSign$offsetHours:$offsetMinutes';
}

/// Example packet demonstrating field-level validation overrides
class UserProfilePacket extends DataPacket {
  /// Unique user identifier
  int? user_id;
  /// Username (alphanumeric, 3-30 chars)
  String? username;
  /// Email address (max 255 chars, overrides global max_string_length)
  String? email;
  /// User biography (max 500 chars, allows empty)
  String? bio;
  /// User age (0-150, overrides global int limits)
  int? age;
  /// Account balance (no NaN/Infinity allowed)
  double? balance;
  /// User tags (max 10 items, overrides global max_list_size)
  List<String>? tags;
  /// User preferences (max 50 entries, max depth 2)
  Map<String, dynamic>? preferences;
  /// Avatar image (max 1MB, overrides global max_bytes_length)
  Uint8List? avatar;
  /// Account creation timestamp
  DateTime? created_at;
  /// Last login timestamp
  DateTime? last_login;

  /// Creates an empty [UserProfilePacket]. Use setters to populate fields.
  UserProfilePacket();

  /// Creates a [UserProfilePacket] with all fields.
  UserProfilePacket.create({
    this.user_id,
    this.username,
    this.email,
    this.bio,
    this.age,
    this.balance,
    this.tags,
    this.preferences,
    this.avatar,
    this.created_at,
    this.last_login,
  });

  @override
  String get type => '/example/UserProfilePacket';

  @override
  Map<String, dynamic> serialize() => {
    'packetType': type,
    'user_id': user_id,
    'username': username,
    'email': email,
    'bio': bio,
    'age': age,
    'balance': balance,
    'tags': tags,
    'preferences': preferences,
    'avatar': avatar != null ? base64Encode(avatar!) : null,
    'created_at': created_at != null ? _formatDateTimeWithTimezone(created_at!) : null,
    'last_login': last_login != null ? _formatDateTimeWithTimezone(last_login!) : null,
  };

  /// Creates a [UserProfilePacket] from a JSON map (internal helper).
  static UserProfilePacket _fromMap(Map<String, dynamic> json) =>
    UserProfilePacket.create(
      user_id: json['user_id'],
      username: json['username'],
      email: json['email'],
      bio: json['bio'],
      age: json['age'],
      balance: (json['balance'] as num?)?.toDouble(),
      tags: (json['tags'] as List<dynamic>?)?.map((e) => e.toString()).toList(),
      preferences: json['preferences'] != null ? Map<String, dynamic>.from(json['preferences'] as Map) : null,
      avatar: json['avatar'] != null ? base64Decode(json['avatar']) : null,
      created_at: json['created_at'] != null ? DateTime.parse(json['created_at']) : null,
      last_login: json['last_login'] != null ? DateTime.parse(json['last_login']) : null,
    );

  /// Serializes this packet to a JSON string.
  String toJson() => jsonEncode(serialize());

  /// Creates a [UserProfilePacket] from a JSON string.
  static UserProfilePacket fromJson(String jsonString) {
    return _fromMap(jsonDecode(jsonString) as Map<String, dynamic>);
  }

  /// Serializes this packet to MessagePack binary format.
  Uint8List toMsgPack() => msgpack.serialize(serialize());

  /// Creates a [UserProfilePacket] from MessagePack binary data.
  static UserProfilePacket fromMsgPack(Uint8List bytes) {
    final data = msgpack.deserialize(bytes);
    return _fromMap(Map<String, dynamic>.from(data as Map));
  }
}
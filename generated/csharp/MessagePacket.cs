// Auto-generated by CrossPacket - do not modify manually
using System;
using System.Collections.Generic;
using System.Text.Json;
using System.Text.Json.Serialization;
using MessagePack;

namespace CrossPacket
{
    /// <summary>
    /// A chat message packet for real-time communication
    /// </summary>
    [MessagePackObject]
    public class MessagePacket
    {
        public const string TYPE = "/chat/MessagePacket";

        [Key("packetType")]
        [JsonPropertyName("packetType")]
        public string Type { get; set; } = TYPE;

        /// <summary>Unique identifier of the sender</summary>
        [Key("sender_id")]
        [JsonPropertyName("sender_id")]
        public string SenderId { get; set; } = "";

        /// <summary>Message content</summary>
        [Key("content")]
        [JsonPropertyName("content")]
        public string Content { get; set; } = "";

        /// <summary>When the message was sent</summary>
        [Key("timestamp")]
        [JsonPropertyName("timestamp")]
        public DateTimeOffset Timestamp { get; set; }

        public MessagePacket() { }

        public MessagePacket(string senderId, string content, DateTimeOffset timestamp)
        {
            this.SenderId = senderId;
            this.Content = content;
            this.Timestamp = timestamp;
        }

        public string ToJson()
        {
            return JsonSerializer.Serialize(this);
        }

        public static MessagePacket? FromJson(string json)
        {
            return JsonSerializer.Deserialize<MessagePacket>(json);
        }

        public byte[] ToMsgPack()
        {
            return MessagePackSerializer.Serialize(this);
        }

        public static MessagePacket FromMsgPack(byte[] data)
        {
            return MessagePackSerializer.Deserialize<MessagePacket>(data);
        }
    }
}
<?php
// Auto-generated by CrossPacket - do not modify manually

declare(strict_types=1);

namespace App\DataPackets;

use DateTimeImmutable;
use DateTimeInterface;
use JsonSerializable;

/**
 * Example packet demonstrating field-level validation overrides
 */
class UserProfilePacket implements JsonSerializable
{
    public const TYPE = '/example/UserProfilePacket';

    /** @var ?int Unique user identifier */
    private ?int $user_id = null;
    /** @var ?string Username (alphanumeric, 3-30 chars) */
    private ?string $username = null;
    /** @var ?string Email address (max 255 chars, overrides global max_string_length) */
    private ?string $email = null;
    /** @var ?string User biography (max 500 chars, allows empty) */
    private ?string $bio = null;
    /** @var ?int User age (0-150, overrides global int limits) */
    private ?int $age = null;
    /** @var ?float Account balance (no NaN/Infinity allowed) */
    private ?float $balance = null;
    /** @var ?array User tags (max 10 items, overrides global max_list_size) */
    private ?array $tags = null;
    /** @var ?array User preferences (max 50 entries, max depth 2) */
    private ?array $preferences = null;
    /** @var ?string Avatar image (max 1MB, overrides global max_bytes_length) */
    private ?string $avatar = null;
    /** @var ?DateTimeImmutable Account creation timestamp */
    private ?DateTimeImmutable $created_at = null;
    /** @var ?DateTimeImmutable Last login timestamp */
    private ?DateTimeImmutable $last_login = null;

    public function __construct(
        ?int $user_id = null,
        ?string $username = null,
        ?string $email = null,
        ?string $bio = null,
        ?int $age = null,
        ?float $balance = null,
        ?array $tags = null,
        ?array $preferences = null,
        ?string $avatar = null,
        ?DateTimeImmutable $created_at = null,
        ?DateTimeImmutable $last_login = null
    )
    {
        $this->user_id = $user_id;
        $this->username = $username;
        $this->email = $email;
        $this->bio = $bio;
        $this->age = $age;
        $this->balance = $balance;
        $this->tags = $tags;
        $this->preferences = $preferences;
        $this->avatar = $avatar;
        $this->created_at = $created_at;
        $this->last_login = $last_login;
    }

    public function getUserId(): ?int
    {
        return $this->user_id;
    }

    public function setUserId(int $user_id): self
    {
        $this->user_id = $user_id;
        return $this;
    }

    public function getUsername(): ?string
    {
        return $this->username;
    }

    public function setUsername(string $username): self
    {
        $this->username = $username;
        return $this;
    }

    public function getEmail(): ?string
    {
        return $this->email;
    }

    public function setEmail(string $email): self
    {
        $this->email = $email;
        return $this;
    }

    public function getBio(): ?string
    {
        return $this->bio;
    }

    public function setBio(?string $bio): self
    {
        $this->bio = $bio;
        return $this;
    }

    public function getAge(): ?int
    {
        return $this->age;
    }

    public function setAge(?int $age): self
    {
        $this->age = $age;
        return $this;
    }

    public function getBalance(): ?float
    {
        return $this->balance;
    }

    public function setBalance(float $balance): self
    {
        $this->balance = $balance;
        return $this;
    }

    public function getTags(): ?array
    {
        return $this->tags;
    }

    public function setTags(array $tags): self
    {
        $this->tags = $tags;
        return $this;
    }

    public function getPreferences(): ?array
    {
        return $this->preferences;
    }

    public function setPreferences(array $preferences): self
    {
        $this->preferences = $preferences;
        return $this;
    }

    public function getAvatar(): ?string
    {
        return $this->avatar;
    }

    public function setAvatar(?string $avatar): self
    {
        $this->avatar = $avatar;
        return $this;
    }

    public function getCreatedAt(): ?DateTimeImmutable
    {
        return $this->created_at;
    }

    public function setCreatedAt(DateTimeImmutable $created_at): self
    {
        $this->created_at = $created_at;
        return $this;
    }

    public function getLastLogin(): ?DateTimeImmutable
    {
        return $this->last_login;
    }

    public function setLastLogin(?DateTimeImmutable $last_login): self
    {
        $this->last_login = $last_login;
        return $this;
    }

    public function jsonSerialize(): array
    {
        return [
            'packetType' => self::TYPE,
            'user_id' => $this->user_id,
            'username' => $this->username,
            'email' => $this->email,
            'bio' => $this->bio,
            'age' => $this->age,
            'balance' => $this->balance,
            'tags' => $this->tags,
            'preferences' => $this->preferences,
            'avatar' => $this->avatar,
            'created_at' => $this->created_at?->format(\DateTimeInterface::ATOM),
            'last_login' => $this->last_login?->format(\DateTimeInterface::ATOM),
        ];
    }

    public function toJson(): string
    {
        return json_encode($this->jsonSerialize(), JSON_THROW_ON_ERROR);
    }

    public static function fromJson(string $json): self
    {
        $data = json_decode($json, true, 512, JSON_THROW_ON_ERROR);
        $instance = new self();
        if (isset($data['user_id'])) {
            $instance->setUserId($data['user_id']);
        }
        if (isset($data['username'])) {
            $instance->setUsername($data['username']);
        }
        if (isset($data['email'])) {
            $instance->setEmail($data['email']);
        }
        if (isset($data['bio'])) {
            $instance->setBio($data['bio']);
        }
        if (isset($data['age'])) {
            $instance->setAge($data['age']);
        }
        if (isset($data['balance'])) {
            $instance->setBalance($data['balance']);
        }
        if (isset($data['tags'])) {
            $instance->setTags($data['tags']);
        }
        if (isset($data['preferences'])) {
            $instance->setPreferences($data['preferences']);
        }
        if (isset($data['avatar'])) {
            $instance->setAvatar($data['avatar']);
        }
        if (isset($data['created_at'])) {
            $instance->setCreatedAt(new \DateTimeImmutable($data['created_at']));
        }
        if (isset($data['last_login'])) {
            $instance->setLastLogin(new \DateTimeImmutable($data['last_login']));
        }
        return $instance;
    }

    public function toMsgPack(): string
    {
        return msgpack_pack($this->jsonSerialize());
    }

    public static function fromMsgPack(string $data): self
    {
        $arr = msgpack_unpack($data);
        $instance = new self();
        if (isset($arr['user_id'])) {
            $instance->setUserId($arr['user_id']);
        }
        if (isset($arr['username'])) {
            $instance->setUsername($arr['username']);
        }
        if (isset($arr['email'])) {
            $instance->setEmail($arr['email']);
        }
        if (isset($arr['bio'])) {
            $instance->setBio($arr['bio']);
        }
        if (isset($arr['age'])) {
            $instance->setAge($arr['age']);
        }
        if (isset($arr['balance'])) {
            $instance->setBalance($arr['balance']);
        }
        if (isset($arr['tags'])) {
            $instance->setTags($arr['tags']);
        }
        if (isset($arr['preferences'])) {
            $instance->setPreferences($arr['preferences']);
        }
        if (isset($arr['avatar'])) {
            $instance->setAvatar($arr['avatar']);
        }
        if (isset($arr['created_at'])) {
            $instance->setCreatedAt(new \DateTimeImmutable($arr['created_at']));
        }
        if (isset($arr['last_login'])) {
            $instance->setLastLogin(new \DateTimeImmutable($arr['last_login']));
        }
        return $instance;
    }
}
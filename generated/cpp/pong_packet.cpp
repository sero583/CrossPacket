// Auto-generated by CrossPacket - do not modify manually
#include "pong_packet.hpp"
#include <cstdlib>

namespace packets {

PongPacket::PongPacket(const std::string& original_timestamp, const std::string& response_timestamp, int64_t latency_ms)
    : original_timestamp_(original_timestamp), response_timestamp_(response_timestamp), latency_ms_(latency_ms) {}

std::string PongPacket::ToJson() const {
    yyjson_mut_doc* doc = yyjson_mut_doc_new(nullptr);
    yyjson_mut_val* root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "packetType", TYPE);
    yyjson_mut_obj_add_strcpy(doc, root, "original_timestamp", original_timestamp_.c_str());
    yyjson_mut_obj_add_strcpy(doc, root, "response_timestamp", response_timestamp_.c_str());
    yyjson_mut_obj_add_int(doc, root, "latency_ms", latency_ms_);

    char* json = yyjson_mut_write(doc, 0, nullptr);
    std::string result(json);
    free(json);
    yyjson_mut_doc_free(doc);
    return result;
}

PongPacket PongPacket::FromJson(const std::string& json) {
    yyjson_doc* doc = yyjson_read(json.c_str(), json.size(), 0);
    if (!doc) {
        throw std::runtime_error("JSON parse error");
    }

    yyjson_val* root = yyjson_doc_get_root(doc);
    PongPacket packet;

    yyjson_val* original_timestamp_val = yyjson_obj_get(root, "original_timestamp");
    if (original_timestamp_val && yyjson_is_str(original_timestamp_val)) {
        packet.original_timestamp_ = yyjson_get_str(original_timestamp_val);
    }
    yyjson_val* response_timestamp_val = yyjson_obj_get(root, "response_timestamp");
    if (response_timestamp_val && yyjson_is_str(response_timestamp_val)) {
        packet.response_timestamp_ = yyjson_get_str(response_timestamp_val);
    }
    yyjson_val* latency_ms_val = yyjson_obj_get(root, "latency_ms");
    if (latency_ms_val && yyjson_is_int(latency_ms_val)) {
        packet.latency_ms_ = yyjson_get_sint(latency_ms_val);
    }

    yyjson_doc_free(doc);
    return packet;
}

std::vector<uint8_t> PongPacket::ToMsgPack() const {
    msgpack::sbuffer buffer;
    msgpack::pack(buffer, *this);
    return std::vector<uint8_t>(buffer.data(), buffer.data() + buffer.size());
}

PongPacket PongPacket::FromMsgPack(const std::vector<uint8_t>& data) {
    msgpack::object_handle oh = msgpack::unpack(reinterpret_cast<const char*>(data.data()), data.size());
    return oh.get().as<PongPacket>();
}

} // namespace packets